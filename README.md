# Технология тиражирования данных
  
**Схема репликации:** Каскадное однонаправленное тиражирование. Изменение (вставка, модификация, удаление), выполненное в одной из ПБД, тиражируется в базу данных следующего уровня.
  
**Запуск репликатора:** Через определенный интервал времени в секундах, задаваемый при запуске программы РД.
  
**Разрешение коллизий:** В пользу более раннего обновления.
    
Описание
-------------------------
  
Разработано WinForm-приложение, имитирующее работу баз данных PostgreSQL через СУБД phpPgAdmin. Перенос данных производится между базами, под которыми подразумеваются 5 таблиц, одинаковой структуры и единого содержимого, находящихся в одной схеме данных.  
  
Три таблицы являются периферийными базами данных (ПБД) нижнего уровня, одна – базой данных первого уровня (БД 1 уровня), и еще одна – базой данных второго уровня (БД 2 уровня).
Все изменения выполняются только в периферийных базах данных (ПБД) и затем транслируются на следующий уровень.
  
Так как в схеме репликации каскадного однонаправленного тиражирования pdb1 и pdb2 вносят данные в БД 1-го уровня, а pdb3 в БД 2-го уровня, то для корректной работы, созданы три журнала изменений.  
  
Первый журнал нужен для отслеживания коллизий при переносе данных в db_level1, второй – для отслеживания поступивших транзакций в pdb3, и третий – для отслеживания коллизий при переносе данных из db_level1 и pdb3 в db_level2.
  
Журнал изменений представлен в виде таблицы приложения (DataGridView). В нем отражается информация о каждой операции (вставка\удаление\обновление).
  
Алгоритм работы с базами данных
-------------------------
  
* Инициализация данных (ИД);
* Имитация работы системы (ИРС): 
  + Программа имитации работы системы c определенным интервалом в несколько секунд (интервал задается в начале запуска) моделирует процесс работы информационной системы, выполняя следующие действия:
      - Случайным образом выбирает одну из условных баз данных (pdb1, pdb2, pdb3).
      - Случайным образом выбирает одну из операций (вставка / обновление / удаление).
      - Выполняет выбранную операцию для выбранной базы данных.	
  + Происходит блокировка доступа к таблицам для программы имитации работы системы (ИРС).
  + Параллельно с работой программы имитации работы данных (ИРС) запускаем программу репликации данных (РД).
  + Останавливаем работу программ имитации работы данных (ИРС) и репликации данных (РД).
  + Анализируем по журналу изменений и журналу содержимого правильность работы схемы репликации.

